# TASK 19 - Hack-a-Gnome
Difficulty: ❄️❄️❄️

## OBJECTIVE : ##
> Davis in the Data Center is fighting a gnome army—join the hack-a-gnome fun.



## HINTS: ##
<details>
  <summary>Hints provided for Task 19</summary>
  
>-	Once you determine the type of database the gnome control factory's login is using, look up its documentation on default document types and properties. This information could help you generate a list of common English first names to try in your attack.


>-  I actually helped design the software that controls the factory back when we used it to make toys. It's quite complex. After logging in, there is a front-end that proxies requests to two main components: a backend Statistics page, which uses a per-gnome container to render a template with your gnome's stats, and the UI, which connects to the camera feed and sends control signals to the factory, relaying them to your gnome (assuming the CAN bus controls are hooked up correctly). Be careful, the gnomes shutdown if you logout and also shutdown if they run out of their 2-hour battery life (which means you'd have to start all over again).


>-  Sometimes, client-side code can interfere with what you submit. Try proxying your requests through a tool like [Burp Suite](https://portswigger.net/burp) or [OWASP ZAP](https://www.zaproxy.org/). You might be able to trigger a revealing error message.

>-  Oh no, it sounds like the CAN bus controls are not sending the correct signals! If only there was a way to hack into your gnome's control stats/signal container to get command-line access to the smart-gnome. This would allow you to fix the signals and control the bot to shut down the factory. During my development of the robotic prototype, we found the factory's pollution to be undesirable, which is why we shut it down. If not updated since then, the gnome might be running on old and outdated packages.

>-  There might be a way to check if an attribute IS_DEFINED on a given entry. This could allow you to brute-force possible attribute names for the target user's entry, which stores their password hash. Depending on the hash type, it might already be cracked and available online where you could find an online cracking station to break it.

>-  Nice! Once you have command-line access to the gnome, you'll need to fix the signals in the canbus_client.py file so they match up correctly. After that, the signals you send through the web UI to the factory should properly control the smart-gnome. You could try sniffing CAN bus traffic, enumerating signals based on any documentation you find, or brute-forcing combinations until you discover the right signals to control the gnome from the web UI.


</details>

#

## PROCEDURE : ##

URI: https://hhc25-smartgnomehack-prod.holidayhackchallenge.com/login?&challenge=termSmartGnome&username=betaj&id=8fd9bfc1-4c4d-446d-bfda-2169f3b46a80&area=gnomefactory&location=6,17&tokens=&dna=ATATATTAATATATATATATATATATATATATCGATTACGATATATATATATTAATATATATATATATTAGCATATCGATATATATATATATTAGCATATATATATATGCGCATATTAGC

If the sheer number of hints for this objective is anything to go by, it's going to be a challenging one!

If we head to the link we're given we are presented with a login screen to access Smart Gnome Control.  There's nothing else to play around with on this screen, apart from a link that says __Register__. This link takes us to a page where we can create a new user and password although we're told that _"Registration is currently closed"_.  There is still somethign that might be useful to us here though...  if we try to enter a username the app checks in realtime to see whetehr the username is taken and lets us know.  So we have a way of querying the database for existing user accounts.

After some playing around with this screen, I found out that typing `"` in the username field triggers an error:

<img width="534" height="521" alt="image" src="https://github.com/user-attachments/assets/34c96d39-208d-446d-ba2a-778340b3479a" />


If we do a quick Google search for this error, we quickly find out that this error is generated by Cosmos DB, so now we can follow the advice of our first hint and read up on default document types and proporties for Cosmos DB.




